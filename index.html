<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>DejandoHuella Trader ‚Äî Landing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="icon" href="img/logo.png" />
  <style>
    :root{
      --bg:#0a0f17; --card:#0f1724; --card2:#0d1522; --fg:#e6e7eb; --muted:#96a0b4;
      --border:#1e2a3b; --accent:#22c55e; --accent-2:#2cf475; --shadow:rgba(0,0,0,.35);
      --red:#ef4444; --green:#22c55e; --link:#7dd3fc; --ink:#051c11; --blue:#3b82f6; --wa:#16a34a;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.45 Inter,Segoe UI,system-ui,Roboto,Arial}
    a{color:var(--link);text-decoration:none}
    .wrap{max-width:1180px;margin:auto;padding:20px}
    /* header */
    .brand{display:flex;gap:14px;align-items:center;flex-wrap:wrap}
    .brand img{width:64px;height:64px;border-radius:14px;border:1px solid var(--border);background:#0b1220;object-fit:cover}
    h1{margin:0;font-size:32px;letter-spacing:.2px}
    .cta{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(180deg,var(--accent-2),var(--accent));color:var(--ink);
         border:0;border-radius:12px;padding:12px 18px;font-weight:800;box-shadow:0 7px 0 #14532d;user-select:none}
    .cta:active{transform:translateY(2px);box-shadow:0 4px 0 #14532d}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .pill{display:inline-flex;align-items:center;gap:10px;border:1px solid var(--border);padding:10px 14px;border-radius:12px;background:#0b1220}
    .btn-fb{background:var(--blue);color:white;border:0;border-radius:12px;padding:12px 18px;font-weight:800;box-shadow:0 6px 0 #1d4ed8}
    .btn-wa{background:var(--wa);color:#071a0d;border:0;border-radius:12px;padding:12px 18px;font-weight:800;box-shadow:0 6px 0 #065f46}
    small,.muted{color:var(--muted)}
    /* cards */
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;margin:18px 0;box-shadow:0 10px 26px var(--shadow)}
    .card.inset{background:var(--card2)}
    h2{margin:0 0 12px;font-size:28px}
    .kv{display:grid;grid-template-columns:auto 1fr;gap:8px 14px}
    .badge{display:inline-block;font-weight:800;border-radius:999px;padding:3px 12px;font-size:13px}
    .badge.buy{background:#093218;color:#22c55e;border:1px solid #14532d}
    .badge.sell{background:#3a0d13;color:#ef4444;border:1px solid #7f1d1d}
    code{background:#0b1220;border:1px solid var(--border);padding:6px 8px;border-radius:10px}
    .copy{cursor:pointer;border:1px solid var(--border);background:#0b1220;color:#bcd7ff;padding:6px 10px;border-radius:10px}
    .grid{display:grid;gap:14px}
    .g2{grid-template-columns:1fr 1fr}
    .bar{display:flex;justify-content:space-between;align-items:center;background:#0b1220;border:1px solid var(--border);
         border-radius:12px;padding:8px 12px;margin:6px 0 14px}
    .btn-x{background:var(--accent);color:var(--ink);font-weight:800;border:0;border-radius:10px;padding:2px 8px;font-size:12px}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid var(--border);padding:10px 8px}
    th{text-align:left;color:#cbd5e1;font-weight:700}
    td.num{text-align:right}
    #hist .card-body{overflow-x:auto;-webkit-overflow-scrolling:touch}
    #hist thead th{position:sticky;top:0;background:#0f172a;z-index:1}
    /* mini control arriba izquierda */
    #refresh-ctrl{position:fixed;top:8px;left:8px;z-index:10000;display:flex;gap:4px;transform:scale(.75);transform-origin:top left;opacity:.9}
    #refresh-ctrl button,#refresh-ctrl label{padding:2px 6px;border-radius:8px;font-size:10px}
    #refresh-ctrl button{background:var(--accent);color:var(--ink);border:0;box-shadow:0 2px 0 #14532d}
    summary{cursor:pointer;font-weight:800;font-size:1.05rem}
    details>div{margin-top:12px}
    footer{background:var(--card2);border:1px solid var(--border);border-radius:16px;padding:18px;margin:24px 0;color:var(--muted)}
    /* QR grid */
    .qr-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
    .qr{background:#0b1220;border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center}
    .qr img{width:180px;height:180px;border-radius:10px;background:#fff;border:1px solid var(--border);object-fit:cover}
    .qr small{display:block;margin-top:8px}
    /* mobile */
    @media (max-width:980px){
      .wrap{padding:16px} h1{font-size:26px} .brand img{width:56px;height:56px}
      .g2{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <!-- control de refresco -->
  <div id="refresh-ctrl">
    <button id="btn-hard">Actualizar ahora</button>
    <label><input id="chk-auto" type="checkbox"> Auto 5s</label>
  </div>

  <!-- aviso superior -->
  <div class="bar" id="top-alert">
    <span>‚ö†Ô∏è Verifica los enlaces oficiales. Usa nuestra <a href="verificacion.html">Verificaci√≥n oficial</a> o la direcci√≥n .onion.</span>
    <button class="btn-x" id="btn-close">√ó</button>
  </div>

  <div class="wrap">
    <!-- header -->
    <div class="brand">
      <img src="img/logo.png" alt="Logo DejandoHuella" loading="lazy" />
      <div>
        <h1>DejandoHuella Trader</h1>
        <div class="row" style="margin-top:6px">
          <a class="cta" href="whatsapp.html">Solicitar informaci√≥n</a>
        </div>
        <div class="muted" style="margin-top:6px">√öltima actualizaci√≥n: <span id="lu"></span></div>
      </div>
    </div>

    <!-- HISTORIAL -->
    <section id="hist" class="card inset">
      <h2>Historial reciente</h2>
      <div id="hist-empty" class="muted">Sin operaciones a√∫n‚Ä¶</div>
      <div class="card-body">
        <table id="hist-table" style="display:none">
          <thead>
            <tr>
              <th>Hora</th><th>Par</th><th>Lado</th>
              <th class="num">Precio</th><th class="num">Lote</th>
              <th class="num">SL</th><th class="num">TP</th>
            </tr>
          </thead>
          <tbody id="hist-body"></tbody>
        </table>
      </div>
    </section>

    <!-- EN VIVO -->
    <section id="live" class="card">
      <h2>Operaciones en vivo</h2>
      <div class="kv">
        <strong>Par:</strong><span id="lv-symbol">‚Äî</span>
        <strong>Lado:</strong><span id="lv-side">‚Äî</span>
        <strong>Precio:</strong><span id="lv-price">‚Äî</span>
        <strong>Lote:</strong><span id="lv-lots">‚Äî</span>
        <strong>SL / TP:</strong><span id="lv-sltp">‚Äî</span>
        <strong>Hora:</strong><span id="lv-ts">‚Äî</span>
      </div>
      <div style="margin-top:10px">
        <img id="lv-shot" alt="Captura MT4 en vivo"
             style="width:100%;max-width:1024px;border-radius:14px;border:1px solid var(--border);box-shadow:0 10px 28px var(--shadow)">
      </div>
    </section>

    <!-- REDES + CONTACTO BAJO REDES -->
    <section class="card inset">
      <h2>Redes oficiales</h2>
      <p class="muted">S√≠guenos para novedades y soporte:</p>
      <div class="row">
        <a class="btn-fb" href="https://www.facebook.com/share/1J54upxdPb/" target="_blank" rel="noopener">Facebook</a>
        <a class="btn-wa" href="whatsapp.html" target="_blank" rel="noopener">WhatsApp</a>
      </div>

      <!-- contacto colocado justo debajo de 'Redes oficiales' -->
      <div class="card" style="margin-top:16px">
        <h2>Contacto</h2>
        <p><a class="cta" href="mailto:dejandohuella_pool@proton.me">Escr√≠benos a ProtonMail</a></p>
        <p>.onion: <b>xsfd6o4hs4lffweef6jnfkfvyhmnldi5ng7zjccev2kouh5grsvvh4yd.onion</b></p>
        <details class="inset" style="margin-top:10px">
          <summary>PGP Public Key ‚Äî Fingerprint</summary>
          <div class="muted" style="margin-top:8px">6C26 A663 02E2 095D CABA E3A4 1372 F256 5381 6452</div>
        </details>
      </div>
    </section>

    <!-- MEDIOS DE PAGO (plegable) -->
    <section class="card">
      <details>
        <summary>üí≥ Medios de Pagos + Planes Premium ‚ÄìDejandoHuella Trader</summary>
        <div class="grid g2">
          <!-- Columna 1 -->
          <div class="card inset">
            <h2>Pagos (verifica la red)</h2>

            <div class="row"><b>BTC</b><span class="pill">Bitcoin</span></div>
            <div class="row">
              <code id="btc">bc1qu6c2036ehv2rssqv32mzv5z9tf92px6q8wp0f4</code>
              <span class="copy" onclick="copyTxt('btc')">Copiar</span>
            </div>
            <div class="qr">
              <img src="qr_btc.png" alt="QR BTC" loading="lazy" />
              <small>Descargar: <a class="cta" href="qr_btc.png" download>PNG</a></small>
            </div>

            <div class="row" style="margin-top:8px"><b>USDT</b><span class="pill">TRC20 ‚Ä¢ Tron</span></div>
            <div class="row">
              <code id="trc20">TCoqxfkqA4MAmTbqtWnCzwBzQToecwSiHd</code>
              <span class="copy" onclick="copyTxt('trc20')">Copiar</span>
            </div>
            <div class="qr">
              <img src="qr_trc20.png" alt="QR TRC20" loading="lazy" />
              <small>Descargar: <a class="cta" href="qr_trc20.png" download>PNG</a></small>
            </div>

            <div class="row" style="margin-top:8px"><b>USDT</b><span class="pill">BEP20 ‚Ä¢ BSC</span></div>
            <div class="row">
              <code id="bep20">0xa721CD06Fce89aAD41e7f8eC6604653712B7c22F</code>
              <span class="copy" onclick="copyTxt('bep20')">Copiar</span>
            </div>
            <div class="qr">
              <img src="qr_bep20.png" alt="QR BEP20" loading="lazy" />
              <small>Descargar: <a class="cta" href="qr_bep20.png" download>PNG</a></small>
            </div>
          </div>

          <!-- Columna 2 -->
          <div class="card inset">
            <div class="row"><b>USDT</b><span class="pill">Arbitrum One</span></div>
            <div class="row">
              <code id="arb1">0xa721CD06Fce89aAD41e7f8eC6604653712B7c22F</code>
              <span class="copy" onclick="copyTxt('arb1')">Copiar</span>
            </div>
            <div class="qr">
              <img src="qr_arbi.png" alt="QR Arbitrum One" loading="lazy" />
              <small>Descargar: <a class="cta" href="qr_arbi.png" download>PNG</a></small>
            </div>

            <div class="row" style="margin-top:8px"><b>USDT</b><span class="pill">ERC-20 ‚Ä¢ Ethereum</span></div>
            <div class="row">
              <code id="erc20">0xa721CD06Fce89aAD41e7f8eC6604653712B7c22F</code>
              <span class="copy" onclick="copyTxt('erc20')">Copiar</span>
            </div>
            <div class="qr">
              <img src="qr_erc20.png" alt="QR ERC-20" loading="lazy" />
              <small>Descargar: <a class="cta" href="qr_erc20.png" download>PNG</a></small>
            </div>

            <hr style="border-color:var(--border);opacity:.5;margin:16px 0" />
            <div class="row"><b>Transferencia bancaria (USD)</b><span class="pill">Banco Pichincha</span></div>
            <p class="muted" style="margin:6px 0 10px">
              <b>Titular:</b> Empresa DejandoHuella<br />
              <b>N¬∞ de cuenta:</b> <code id="cta-pich">2207922413</code> <span class="copy" onclick="copyTxt('cta-pich')">Copiar</span><br />
              <b>Referencia:</b> ‚ÄúDejandoHuella + tu nombre‚Äù
            </p>
            <div class="qr">
              <img src="img/qr-pichincha.png" alt="QR Banco Pichincha" />
              <small>Descargar: <a class="cta" href="img/qr-pichincha.png" download>PNG</a></small>
            </div>

            <div class="card inset" style="margin-top:14px">
              <h2>Planes Premium ‚Äî Transparencia</h2>
              <ul>
                <li>‚úÖ Se√±ales Premium (BTC/USD) ‚Äî framework BREAK_L2</li>
                <li>‚úÖ EA MT4 con licencia, setup y soporte</li>
                <li>‚úÖ Reportes, trazabilidad y mentor√≠a</li>
              </ul>
              <p class="muted" style="margin-top:6px">
                Clearnet: <a href="./">Abrir sitio</a> |
                Contacto: <a href="mailto:dejandohuella_pool@proton.me">dejandohuella_pool@proton.me</a>
              </p>
            </div>
          </div>
        </div>
      </details>
    </section>

    <footer>
      <small>¬© 2025 DejandoHuella Trader</small>
    </footer>
  </div>

  <!-- ===== LIVE_BASE =====
       - En .onion o Nginx local: '' (vac√≠o, usa /live/ del mismo host)
       - En GitHub Pages: 'https://live.TU-DOMINIO' (Cloudflare Tunnel o VPS con HTTPS) -->
  <script>
    window.LIVE_BASE = ''; // ejemplo para GH Pages: 'https://live.dejandohuella.site'
    const liveUrl = (p)=> (window.LIVE_BASE||'').replace(/\/$/,'') + p;
  </script>

  <script>
    // helpers
    const $ = (s)=>document.querySelector(s);
    const nice=(n,dp)=> (n==null||n==='')?'‚Äî':(dp==null?Number(n):Number(n).toFixed(dp));
    const tsLocal=(ts)=>{ if(!ts) return '‚Äî'; const d=new Date(ts.replace(/\./g,'-').replace(' ','T')); return isNaN(+d)?ts:d.toLocaleString(); };
    const tagSide=(s)=>{ s=(s||'').toUpperCase(); if(s.includes('BUY')) return `<span class="badge buy">BUY</span>`; if(s.includes('SELL')) return `<span class="badge sell">SELL</span>`; return '‚Äî'; };
    function copyTxt(id){
      const e=document.getElementById(id); if(!e) return;
      const t=e.textContent.trim();
      if(navigator.clipboard && window.isSecureContext){ navigator.clipboard.writeText(t); }
      else{ const ta=document.createElement('textarea'); ta.value=t; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); }
    }

    // fecha y banner
    $('#lu').textContent = new Date().toISOString().slice(0,10);
    $('#btn-close')?.addEventListener('click',()=> $('#top-alert')?.remove());

    // imagen en vivo
    (function(){
      const img = $('#lv-shot');
      function set(){ img.src = liveUrl('/live/shots/latest.jpg') + '?ts=' + Date.now(); }
      set(); setInterval(set, 2500);
    })();

    // √∫ltimo trade
    async function loopLast(){
      try{
        const r = await fetch(liveUrl('/live/last.json')+'?ts='+Date.now(),{cache:'no-store'});
        const txt = await r.text();
        const a=txt.indexOf('{'), b=txt.lastIndexOf('}'); const json=(a>=0&&b>=0)?txt.slice(a,b+1):txt;
        const d = JSON.parse(json);
        $('#lv-symbol').textContent = d.symbol||'‚Äî';
        $('#lv-side').innerHTML    = tagSide(d.side);
        $('#lv-price').textContent = nice(d.price);
        $('#lv-lots').textContent  = nice(d.lots,2);
        $('#lv-sltp').textContent  = `${nice(d.sl)} / ${nice(d.tp)}`;
        $('#lv-ts').textContent    = tsLocal(d.ts);
      }catch(_){}
      setTimeout(loopLast, 2500);
    }
    loopLast();

    // historial
    async function loopHist(){
      const table = $('#hist-table'), body=$('#hist-body'), empty=$('#hist-empty');
      function render(rows){
        if(!rows.length){ table.style.display='none'; empty.style.display='block'; return; }
        empty.style.display='none'; table.style.display='table';
        body.innerHTML = rows.map(r=>`
          <tr>
            <td>${tsLocal(r.ts)}</td>
            <td>${r.symbol||'‚Äî'}</td>
            <td>${tagSide(r.side)}</td>
            <td class="num">${nice(r.price)}</td>
            <td class="num">${nice(r.lots,2)}</td>
            <td class="num">${nice(r.sl)}</td>
            <td class="num">${nice(r.tp)}</td>
          </tr>`).join('');
      }
      try{
        const r = await fetch(liveUrl('/live/trades.jsonl')+'?ts='+Date.now(),{cache:'no-store'});
        if(!r.ok){ render([]); return; }
        const txt = await r.text();
        const lines = (txt||'').trim().split(/\r?\n/).filter(Boolean);
        const objs = lines.slice(-10).map(l=>{try{return JSON.parse(l);}catch(_){return null;}}).filter(Boolean).reverse();
        render(objs);
      }catch(_){ render([]); }
      setTimeout(loopHist, 5000);
    }
    loopHist();

    // recarga completa + auto 5s
    (function(){
      const btn=$('#btn-hard'); const chk=$('#chk-auto'); let t=null;
      function start(){ stop(); t=setInterval(()=>location.reload(),5000); }
      function stop(){ if(t){clearInterval(t); t=null;} }
      btn?.addEventListener('click',()=>{ const u=new URL(location.href); u.searchParams.set('ts',Date.now()); location.replace(u.toString()); });
      chk?.addEventListener('change',()=>{ chk.checked?start():stop(); try{localStorage.setItem('dh_auto_5s',chk.checked?'1':'');}catch(_){}});
      try{ if(localStorage.getItem('dh_auto_5s')==='1'){ chk.checked=true; start(); } }catch(_){}
    })();
  </script>
</body>
</html>
